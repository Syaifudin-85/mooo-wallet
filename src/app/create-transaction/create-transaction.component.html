<navigation-bar header="Create Transaction"></navigation-bar>

<main>
    <div class="container">
        <div class="row">
            <div class="input-field col s9 m8 l8">
                <input id="address" type="text" [(ngModel)]="from"/>            
                <label for="address">Address</label>
            </div>
            <div class="col s3 m4 l4" style="margin-top: 0.5rem">
                <a class="waves-effect waves-light btn-large pulse" [ngClass]="{'pulse': from == null}" (click)="loadUTXO()">Load UTXO</a>
            </div>
        </div>
        <div *ngIf="utxoArray.length > 0" class="row">
            <table>
                <thead>
                    <tr>
                        <th>Amount</th>
                        <th>Number of confirmations</th>
                        <th>Transaction ID</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let utxo of utxoArray; let i = index" [attr.data-index]="i">
                        <td>{{utxo.amount}}&nbsp;{{environment.btc}}</td>
                        <td>{{utxo.confirmations}}</td>
                        <!--                        <td class="show-on-small" style="max-width: 140px"><span class="truncate">{{utxo.txid}}</span></td>
                                                <td class="show-on-medium" style="max-width: 200px"><span class="truncate">{{utxo.txid}}</span></td>
                                                <td class="show-on-large">{{utxo.txid}}</td>-->
                        <td class="hide-on-med-and-up" style="max-width: 140px"><span class="truncate">{{utxo.txid}}</span></td>
                        <td class="hide-on-small-and-down">{{utxo.txid}}</td>
                        <td>
                            <a class="waves-effect waves-light btn-floating secondary-content" (click)="removeUTXO(i)">
                                <i class="material-icons">remove</i>
                            </a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div *ngIf="utxoArray.length > 0" class="row center-align">
            <h1>
                Balance : <span class="blue lighten-4 blue-text text-lighten-2" style="border-radius: 0.3rem; padding: 0.5rem">{{balance}}&nbsp;{{environment.btc}}</span>
            </h1>
        </div>
        <div *ngIf="balance > 0" class="row">
            <div class="input-field col s8 l5 xl4">
                <input id="amount-to-send" type="number" step="0.00000001" [(ngModel)]="selectedAmount"/>
                <label for="amount-to-send">Amount to send in {{environment.btc}}</label>
            </div>
            <div class="input-field col s10 l6 xl7">
                <input id="destination" type="text" [(ngModel)]="selectedDestination"/>
                <label for="destination">Destination</label>
            </div>
            <div class="col s2 l1" style="margin-top: 1.4rem">
                <a class="waves-effect waves-light btn-floating secondary-content" (click)="addDestination()">
                    <i class="material-icons">add</i>
                </a>
            </div>
        </div>
        <div *ngIf="outputArray.length > 0" class="row">
            <table>
                <thead>
                    <tr>
                        <th>Amount</th>
                        <th>Destination</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let output of outputArray; let i = index" [attr.data-index]="i">
                        <td>{{output.amount}}&nbsp;{{environment.btc}}</td>
                        <td>{{output.destination}}</td>
                        <td>
                            <a class="waves-effect waves-light btn-floating secondary-content" (click)="removeDestination(i)">
                                <i class="material-icons">remove</i>
                            </a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div *ngIf="outputArray.length > 0" class="row center-align">
            <h5>Transaction Fee: {{transactionFee}}&nbsp;{{environment.btc}}</h5>
        </div>
        <div *ngIf="outputArray.length > 0 && transactionHex == null" class="row">
            <div class="center-align">
                <a class="waves-effect waves-light btn" [ngClass]="{'pulse': transactionHex == null}" (click)="createTransaction()">Create transaction</a>
            </div>
        </div>
        <div *ngIf="transactionHex != null" class="row">
            <div>
                <label for="rawTransaction">Raw transaction</label>
                <textarea id="rawTransaction" class="materialize-textarea" readonly>{{transactionHex}}</textarea>
            </div>
        </div>
        <div *ngIf="transactionHex != null" class="row center-align">
            <div class="col s12" style="margin-top: 0.5rem">
                <a class="waves-effect waves-light btn" (click)="clean()">Clean</a>
            </div>
        </div>
    </div>
</main>